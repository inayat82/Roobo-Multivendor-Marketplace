"use strict";(()=>{var e={};e.id=42,e.ids=[42],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9539:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var t={};o.r(t),o.d(t,{GET:()=>c});var s=o(3278),a=o(5002),n=o(4877),i=o(1309);let p=require("crypto");var u=o.n(p);async function c(e){console.log("Shopify auth request:",e.url);let r=new URL(e.url).searchParams.get("shop");if(!r)return console.error("No shop parameter provided"),i.NextResponse.json({error:"Shop parameter is required"},{status:400});let o=r.includes(".myshopify.com")?r:`${r}.myshopify.com`;console.log("Processing auth for shop:",o);try{let e=process.env.SHOPIFY_API_KEY,r="read_products,write_products,read_orders,write_orders,read_customers",t=`${process.env.APP_URL}/api/auth/shopify/callback`,s=u().randomBytes(16).toString("hex");if(!e)throw Error("SHOPIFY_API_KEY not configured");let a=new URL(`https://${o}/admin/oauth/authorize`);return a.searchParams.set("client_id",e),a.searchParams.set("scope",r),a.searchParams.set("redirect_uri",t),a.searchParams.set("state",s),console.log("=== OAUTH DEBUG INFO ==="),console.log("Shop Domain:",o),console.log("API Key:",e),console.log("Scopes:",r),console.log("Redirect URI:",t),console.log("State:",s),console.log("Full Auth URL:",a.toString()),console.log("=== END DEBUG INFO ==="),i.NextResponse.redirect(a.toString())}catch(r){console.error("Shopify auth error:",r);let e=r instanceof Error?r.message:"Unknown error";return i.NextResponse.json({error:"Authentication failed",details:e},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/shopify/route",pathname:"/api/auth/shopify",filename:"route",bundlePath:"app/api/auth/shopify/route"},resolvedPagePath:"C:\\Users\\inaya\\OneDrive\\Desktop\\Project 2025\\pos-app-26-Aug-9AM (2)\\multivendor-marketplace\\app\\api\\auth\\shopify\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:h,staticGenerationAsyncStorage:d,serverHooks:m}=l,g="/api/auth/shopify/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[787,833],()=>o(9539));module.exports=t})();